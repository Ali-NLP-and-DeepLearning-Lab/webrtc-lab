<% include ../../partials/header %>
<div id="content">
  <div class="wrap">
    <video autoplay></video>
    <button>getUserMedia()</button>

    <pre>
      <code class="highlight">$(function() {
  navigator.getUserMedia = navigator.getUserMedia ||
  	navigator.webkitGetUserMedia || navigator.mozGetUserMedia;

  $('button').click(function() {
    // getUserMedia(접근할 미디어, 성공 callback, 실패 callback);
    navigator.getUserMedia({audio:true, video:true}, success, error);
  });

  function success(stream) {
    // 비디오 테그에 stream 할당
    $('video')[0].srcObject = stream;

    // do something...
  }

  function error(err) {
    console.log('error', arguments);
  }
});</code>
   	</pre>
  </div>
</div>

<script>
  $(function() {
    navigator.getUserMedia = navigator.getUserMedia ||
    	navigator.webkitGetUserMedia || navigator.mozGetUserMedia;

    $('button').click(function() {

      if (DetectRTC.browser.isEdge) {
        navigator.getDisplayMedia({ video: true })
          .then(success, error);

      } else {
        // getUserMedia(접근할 미디어, 성공 callback, 실패 callback);
        // navigator.getUserMedia({audio:true, video:true}, success, error);
        navigator.getUserMedia({
          audio: true,
          video: {
            width: {
              max: 1280
            },
            height: {
              max: 720
            },
            frameRate: {
              min: 10
            }
          }
        }, success, error);
      }
    });

    function success(stream) {
      console.log('success', arguments);
      
      // 비디오 테그에 stream 할당
      $('video')[0].srcObject = stream;

      // do something...
    }

    function error(error) {
      console.log('error', arguments);

      alert('카메라와 마이크를 허용해주세요');
    }
  });
</script>
<% include ../../partials/footer %>
